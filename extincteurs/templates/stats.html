


{% load static %}

<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="icon" href="{% static 'img/favicon.png' %}" type="image logo">
        <title>Statistiques</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
        <link rel="stylesheet" href="{% static 'css/style.css' %}">
        <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
    </head>
    <body>
        
        <header class="header_area">
            <div class="main_menu">
                <nav class="navbar navbar-expand-lg navbar-light" style="background-color: black;">
                    <div class="container box_1620">
                        <a class="navbar-brand logo_h" href="{% url 'home' %}"><img src="{% static 'img/crtv.png' %}" width="50px" height="50px" alt=""></a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <div class="collapse navbar-collapse offset" id="navbarSupportedContent">
                            <ul class="nav navbar-nav menu_nav justify-content-center">
                                <li class="nav-item active"><a class="nav-link" href="{% url 'home' %}">Home</a></li> 
                                <li class="nav-item"><a class="nav-link" href="{% url 'gestion_extincteurs' %}">Extincteurs</a></li> 
                                <li class="nav-item"><a class="nav-link" href="{% url 'contact' %}">Contact</a></li>
                            </ul>
                            <ul class="nav navbar-nav navbar-right">
                                <a href="{% url 'logout' %}" class="tickets_btn">se deconnecter</a>
                            </ul>
                        </div> 
                    </div>
                </nav>
            </div>
        </header>
        <!--================Header Menu Area =================-->
        <br/><br/>
        <div class="made_life_area p_100">
            <section>
                <div class="row">
                    <div class="col-md-12 mb-4">
                        <br/><br/>
                        <div class="card card-default rounded-0 shadow border border-dark">
                            <div class="card-body">
                                
                                <h2 class="text-center fw-bold">Statistiques de l'application</h2>
                                <hr>
                            </div>
                        </div>
                    </div>
    
                    <!-- Total Users -->
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card rounded-0 shadow border-primary text-start summary-card">
                            <div class="card-body d-flex">
                                <div class="col-8">
                                    <div class="summary-title fs-5 border-bottom">Total des utilisateurs </div>
                                    <div class="summary-count text-end fw-bolder mt-3 px-4">{{ total_utilisateurs }}</div>
                                </div>
                                <div class="col-4 d-flex align-items-center justify-content-center">
                                    <div class="summary-icon p-3 rounded border text-center bg-gradient bg-light">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
                                          </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Total Conferences -->
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card rounded-0 shadow border-success text-start summary-card">
                            <div class="card-body d-flex">
                                <div class="col-8">
                                    <div class="summary-title fs-5 border-bottom">Total des inspections</div>
                                    <div class="summary-count text-end fw-bolder mt-3 px-4">{{ total_inspections }}</div>
                                </div>
                                <div class="col-4 d-flex align-items-center justify-content-center">
                                    <div class="summary-icon p-3 rounded border text-center bg-gradient bg-light">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sign-merge-left" viewBox="0 0 16 16">
                                            <path d="M7.25 6v1q-.211.451-.588.95c-.537.716-1.259 1.44-2.016 2.196l.708.708.015-.016c.652-.652 1.33-1.33 1.881-2.015V12h1.5V6h1.216a.25.25 0 0 0 .192-.41L8.192 3.23a.25.25 0 0 0-.384 0L5.842 5.59a.25.25 0 0 0 .192.41z"/>
                                            <path d="M9.05.435c-.58-.58-1.52-.58-2.1 0L.436 6.95c-.58.58-.58 1.519 0 2.098l6.516 6.516c.58.58 1.519.58 2.098 0l6.516-6.516c.58-.58.58-1.519 0-2.098zm-1.4.7a.495.495 0 0 1 .7 0l6.516 6.515a.495.495 0 0 1 0 .7L8.35 14.866a.495.495 0 0 1-.7 0L1.134 8.35a.495.495 0 0 1 0-.7L7.65 1.134Z"/>
                                          </svg>                                   
                                     </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Total Communicators -->
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card rounded-0 shadow border-info text-start summary-card">
                            <div class="card-body d-flex">
                                <div class="col-8">
                                    <div class="summary-title fs-5 border-bottom">Total des extincteurs</div>
                                    <div class="summary-count text-end fw-bolder mt-3 px-4">{{ total_extincteurs }}</div>
                                </div>
                                <div class="col-4 d-flex align-items-center justify-content-center">
                                    <div class="summary-icon p-3 rounded border text-center bg-gradient bg-light">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-xbox" viewBox="0 0 16 16">
                                            <path d="M7.202 15.967a8 8 0 0 1-3.552-1.26c-.898-.585-1.101-.826-1.101-1.306 0-.965 1.062-2.656 2.879-4.583C6.459 7.723 7.897 6.44 8.052 6.475c.302.068 2.718 2.423 3.622 3.531 1.43 1.753 2.088 3.189 1.754 3.829-.254.486-1.83 1.437-2.987 1.802-.954.301-2.207.429-3.239.33m-5.866-3.57C.589 11.253.212 10.127.03 8.497c-.06-.539-.038-.846.137-1.95.218-1.377 1.002-2.97 1.945-3.95.401-.417.437-.427.926-.263.595.2 1.23.638 2.213 1.528l.574.519-.313.385C4.056 6.553 2.52 9.086 1.94 10.653c-.315.852-.442 1.707-.306 2.063.091.24.007.15-.3-.319Zm13.101.195c.074-.36-.019-1.02-.238-1.687-.473-1.443-2.055-4.128-3.508-5.953l-.457-.575.494-.454c.646-.593 1.095-.948 1.58-1.25.381-.237.927-.448 1.161-.448.145 0 .654.528 1.065 1.104a8.4 8.4 0 0 1 1.343 3.102c.153.728.166 2.286.024 3.012a9.5 9.5 0 0 1-.6 1.893c-.179.393-.624 1.156-.82 1.404-.1.128-.1.127-.043-.148ZM7.335 1.952c-.67-.34-1.704-.705-2.276-.803a4 4 0 0 0-.759-.043c-.471.024-.45 0 .306-.358A7.8 7.8 0 0 1 6.47.128c.8-.169 2.306-.17 3.094-.005.85.18 1.853.552 2.418.9l.168.103-.385-.02c-.766-.038-1.88.27-3.078.853-.361.176-.676.316-.699.312a12 12 0 0 1-.654-.319Z"/>
                                        </svg>                                   
                                     </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Certificates Printed -->
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card rounded-0 shadow border-warning text-start summary-card">
                            <div class="card-body d-flex">
                                <div class="col-8">
                                    <div class="summary-title fs-5 border-bottom">Total des rapports d'inspection</div>
                                    <div class="summary-count text-end fw-bolder mt-3 px-4">{{ total_rapports }}</div>
                                </div>
                                <div class="col-4 d-flex align-items-center justify-content-center">
                                    <div class="summary-icon p-3 rounded border text-center bg-gradient bg-light">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-view-list" viewBox="0 0 16 16">
                                            <path d="M3 4.5h10a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2m0 1a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1zM1 2a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 2m0 12a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 14"/>
                                          </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Last Conference Date -->
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="card rounded-0 shadow border-dark text-start summary-card">
                            <div class="card-body d-flex">
                                <div class="col-8">
                                    <div class="summary-title fs-5 border-bottom">Dernière inspection effectuée</div>
                                    <div class="summary-count text-end fw-bolder mt-3 px-4">{{ derniere_inspection }}</div>
                                </div>
                                <div class="col-4 d-flex align-items-center justify-content-center">
                                    <div class="summary-icon p-3 rounded border text-center bg-gradient bg-light">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-date" viewBox="0 0 16 16">
                                            <path d="M6.445 11.688V6.354h-.633A13 13 0 0 0 4.5 7.16v.695c.375-.257.969-.62 1.258-.777h.012v4.61zm1.188-1.305c.047.64.594 1.406 1.703 1.406 1.258 0 2-1.066 2-2.871 0-1.934-.781-2.668-1.953-2.668-.926 0-1.797.672-1.797 1.809 0 1.16.824 1.77 1.676 1.77.746 0 1.23-.376 1.383-.79h.027c-.004 1.316-.461 2.164-1.305 2.164-.664 0-1.008-.45-1.05-.82zm2.953-2.317c0 .696-.559 1.18-1.184 1.18-.601 0-1.144-.383-1.144-1.2 0-.823.582-1.21 1.168-1.21.633 0 1.16.398 1.16 1.23"/>
                                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
                                          </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
    
            <div class="container">
                
                <div class="row">
                    <!-- Graphique circulaire des inspections par type -->
                    <div class="col-md-6">
                        <h3>Inspections par type</h3>
                        <canvas id="inspectionsParType" style="width: 50px; height: 50px;"></canvas>
                    </div>
            
                    <!-- Graphique en bâton des inspections par mois -->
                    <div class="col-md-6">
                        <h3 class="mt-4 mt-md-0">Inspections par mois</h3>
                        <canvas id="inspectionsParMois" style="width: 50px; height: 50px;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    
        <script>
            // Graphique circulaire des inspections par type
            var ctx = document.getElementById('inspectionsParType').getContext('2d');
            var inspectionsParTypeChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: [
                        {% for item in inspections_par_type %}
                            "{{ item.type_inspection }}",
                        {% endfor %}
                    ],
                    datasets: [{
                        label: 'Inspections par type',
                        data: [
                            {% for item in inspections_par_type %}
                                {{ item.count }},
                            {% endfor %}
                        ],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true
                }
            });
        
            // Graphique en bâton des inspections par mois
            var ctx2 = document.getElementById('inspectionsParMois').getContext('2d');
            var inspectionsParMoisChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: [
                        {% for item in inspections_par_mois %}
                            "{{ item.month }}",
                        {% endfor %}
                    ],
                    datasets: [{
                        label: 'Nombre d\'inspections',
                        data: [
                            {% for item in inspections_par_mois %}
                                {{ item.count }},
                            {% endfor %}
                        ],
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    responsive: true
                }
            });
        </script>
        
        

        <!--================Footer Area =================-->
        <footer class="footer_area p_120">
        	<div class="container">
        		<div class="row footer_inner">
        			<div class="col-lg-5 col-sm-6">
        				<aside class="f_widget ab_widget">
        					<p> Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved by <a href="https://colorlib.com" target="_blank">Anne Piedjou</a> </p>
							<a href="index.html"><img src="{%  static 'img/crtv.png' %}" width="80px" height="80px" alt=""></a>
        				</aside>
        			</div>
        		</div>
        	</div>
        </footer>



        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
        <script src="{% static 'js/popper.js' %}"></script>
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="{% static 'js/stellar.js' %}"></script>
        <script src="{% static 'vendors/lightbox/simpleLightbox.min.js' %}"></script>
        <script src="{% static 'vendors/nice-select/js/jquery.nice-select.min.js' %}"></script>
        <script src="{% static 'vendors/isotope/imagesloaded.pkgd.min.js' %}"></script>
        <script src="{% static 'vendors/isotope/isotope-min.js' %}"></script>
        <script src="{% static 'vendors/owl-carousel/owl.carousel.min.js' %}"></script>
        <script src="{% static 'js/jquery.ajaxchimp.min.js' %}"></script>
        <script src="{% static 'vendors/counter-up/jquery.waypoints.min.js' %}"></script>
        <script src="{% static 'vendors/counter-up/jquery.counterup.min.js' %}"></script>
        <script src="{% static 'js/mail-script.js' %}"></script>

    </body>
</html>
